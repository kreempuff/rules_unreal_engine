"""BLAKE3 cryptographic hash function.

Fast cryptographic hashing based on Bao and BLAKE2.
We build from source instead of using Epic's prebuilt libraries for hermetic builds.

Converted from: Engine/Source/ThirdParty/BLAKE3/BLAKE3.Build.cs
"""

load("@rules_unreal_engine//bzl:module.bzl", "ue_module")

# BLAKE3 has C source files - ue_module now detects and handles them correctly
ue_module(
    name = "BLAKE3",
    module_type = "ThirdParty",

    # C source files (will be compiled with -std=c11, not -std=c++20)
    srcs = [
        "1.3.1/c/blake3.c",
        "1.3.1/c/blake3_dispatch.c",
        "1.3.1/c/blake3_portable.c",
        "1.3.1/c/blake3_sse2.c",
        "1.3.1/c/blake3_sse41.c",
        "1.3.1/c/blake3_avx2.c",
        "1.3.1/c/blake3_avx512.c",
        # TODO: Add platform-specific:
        # "1.3.1/c/blake3_neon.c",  # ARM
    ],

    hdrs = [
        "1.3.1/c/blake3.h",
        "1.3.1/c/blake3_impl.h",
    ],

    # From BLAKE3.Build.cs: PublicSystemIncludePaths
    public_includes = ["1.3.1/c"],

    visibility = ["//visibility:public"],
)
